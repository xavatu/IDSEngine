COLUMNS = [
    "timestamp",
    "flow_id",
    "pcap_cnt",
    "event_type",
    "src_ip",
    "src_port",
    "dest_ip",
    "dest_port",
    "proto",
    "pkt_src",
    "alert_action",
    "alert_gid",
    "alert_signature_id",
    "alert_rev",
    "alert_signature",
    "alert_category",
    "alert_severity",
    "app_proto",
    "direction",
    "flow_pkts_toserver",
    "flow_pkts_toclient",
    "flow_bytes_toserver",
    "flow_bytes_toclient",
    "flow_start",
    "flow_src_ip",
    "flow_dest_ip",
    "flow_src_port",
    "flow_dest_port",
    "payload",
    "payload_printable",
    "stream",
    "packet",
    "linktype",
    "http_hostname",
    "http_url",
    "http_user_agent",
    "http_method",
    "http_protocol",
    "http_length",
    "zap_scan_id",
    "vuln_name",
]

FEATURES = [
    # "timestamp",
    # "flow_id",
    # "pcap_cnt",
    # "event_type",
    "src_ip",
    "src_port",
    "dest_ip",
    "dest_port",
    "proto",
    # "pkt_src",
    # "alert_action",
    # "alert_gid",
    # "alert_signature_id",
    # "alert_rev",
    # "alert_signature",
    # "alert_category",
    # "alert_severity",
    "app_proto",
    "direction",
    "flow_pkts_toserver",
    "flow_pkts_toclient",
    "flow_bytes_toserver",
    "flow_bytes_toclient",
    # "flow_start",
    # "flow_src_ip",
    # "flow_dest_ip",
    # "flow_src_port",
    # "flow_dest_port",
    "payload",
    "payload_printable",
    # "stream",
    # "packet",
    # "linktype",
    "http_hostname",
    "http_url",
    "http_user_agent",
    "http_method",
    "http_protocol",
    "http_length",
    # "zap_scan_id",
    # "vuln_name",
]

NUMERIC_FEATURES = [
    "flow_pkts_toserver",
    "flow_pkts_toclient",
    "flow_bytes_toserver",
    "flow_bytes_toclient",
    "http_length",
]

TEXT_FEATURES = [
    "payload",
    "payload_printable",
    "http_hostname",
    "http_url",
    "http_user_agent",
]

CATEGORICAL_FEATURES = [
    "proto",
    "app_proto",
    "http_method",
    "http_protocol",
]

IP_FEATURES = [
    "src_ip",
    "dest_ip",
    "src_port",
    "dest_port",
]

TARGET = "vuln_name"

LABELS = [
    None,
    ".htaccess Information Leak",
    "XSLT Injection",
    "Cloud Metadata Potentially Exposed",
    "Parameter Tampering",
    "Source Code Disclosure - CVE-2012-1823",
    "XPath Injection",
    "Server Side Template Injection",
    "Buffer Overflow",
    "SQL Injection - Hypersonic SQL",
    "SQL Injection - SQLite",
    "Remote File Inclusion",
    "Cross Site Scripting (Persistent) - Spider",
    "Directory Browsing",
    "External Redirect",
    "Cross Site Scripting (Persistent) - Prime",
    "SQL Injection - PostgreSQL",
    "Source Code Disclosure - /WEB-INF Folder",
    "Server Side Include",
    "Remote OS Command Injection",
    "Path Traversal",
    ".env Information Leak",
    "Format String Error",
    "ELMAH Information Leak",
    "Hidden File Found",
    "Server Side Code Injection",
    "Trace.axd Information Leak",
    "SQL Injection",
    "Spring4Shell",
    "Remote Code Execution - CVE-2012-1823",
    "SQL Injection - Oracle",
    "Cross Site Scripting (Reflected)",
    "CRLF Injection",
    "Spring Actuator Information Leak",
    "SQL Injection - MsSQL",
    "User Agent Fuzzer",
    "SQL Injection - MySQL",
]

# from collections import Counter
# import pandas as pd
# df = pd.read_csv("marked.csv")
# print(Counter(df["vuln_name"]))
LABELS_COUNT = {
    None: 94072,
    "Remote OS Command Injection": 5736,
    "Path Traversal": 5515,
    "SQL Injection - SQLite": 4902,
    "Remote File Inclusion": 4188,
    "Server Side Template Injection": 3528,
    "SQL Injection": 2994,
    "SQL Injection - MySQL": 1323,
    "SQL Injection - PostgreSQL": 1008,
    "SQL Injection - Hypersonic SQL": 984,
    "SQL Injection - MsSQL": 945,
    "SQL Injection - Oracle": 820,
    "External Redirect": 756,
    "Server Side Code Injection": 504,
    "Parameter Tampering": 454,
    "CRLF Injection": 357,
    "XSLT Injection": 296,
    "Server Side Include": 260,
    "Cloud Metadata Potentially Exposed": 252,
    "Cross Site Scripting (Reflected)": 241,
    "XPath Injection": 189,
    "Hidden File Found": 178,
    "Format String Error": 155,
    "User Agent Fuzzer": 144,
    "Spring Actuator Information Leak": 80,
    "Cross Site Scripting (Persistent) - Prime": 63,
    "Buffer Overflow": 59,
    "Spring4Shell": 25,
    "Remote Code Execution - CVE-2012-1823": 24,
    "Source Code Disclosure - CVE-2012-1823": 12,
    "Cross Site Scripting (Persistent) - Spider": 12,
    "Directory Browsing": 12,
    "Source Code Disclosure - /WEB-INF Folder": 8,
    "Trace.axd Information Leak": 6,
    ".htaccess Information Leak": 6,
    ".env Information Leak": 6,
    "ELMAH Information Leak": 2,
}

ALIASES = {
    "NORMAL": (None,),
    "SQL_INJECTION": (
        "SQL Injection - SQLite",
        "SQL Injection",
        "SQL Injection - MySQL",
        "SQL Injection - PostgreSQL",
        "SQL Injection - Hypersonic SQL",
        "SQL Injection - MsSQL",
        "SQL Injection - Oracle",
    ),
    "OS_COMMAND_INJECTION": (
        "Remote OS Command Injection",
        "Remote Code Execution - CVE-2012-1823",
        "Spring4Shell",
    ),
    "SERVER_SIDE_TEMPLATE_INJECTION": ("Server Side Template Injection",),
    "SERVER_SIDE_CODE_INJECTION": ("Server Side Code Injection",),
    "XML_EXPLOITING": (
        "XSLT Injection",
        "XPath Injection",
    ),
    "FILE_INCLUSION": (
        "Remote File Inclusion",
        "Server Side Include",
    ),
    "PATH_TRAVERSAL": ("Path Traversal",),
    "CRLF_INJECTION": ("CRLF Injection",),
    "FORMAT_STRING": ("Format String Error",),
    "BUFFER_OVERFLOW": ("Buffer Overflow",),
    "XSS": (
        "Cross Site Scripting (Reflected)",
        "Cross Site Scripting (Persistent) - Prime",
        "Cross Site Scripting (Persistent) - Spider",
    ),
    "OPEN_REDIRECT": ("External Redirect",),
    "PARAMETER_MANIPULATION": ("Parameter Tampering",),
    "FUZZER": ("User Agent Fuzzer",),
    "INFORMATION_LEAK": (
        "Cloud Metadata Potentially Exposed",
        "Spring Actuator Information Leak",
        "Trace.axd Information Leak",
        ".htaccess Information Leak",
        ".env Information Leak",
        "ELMAH Information Leak",
    ),
    "SOURCE_CODE_DISCLOSURE": (
        "Source Code Disclosure - CVE-2012-1823",
        "Source Code Disclosure - /WEB-INF Folder",
    ),
    "DIRECTORY_INDEXING": (
        "Directory Browsing",
        "Hidden File Found",
    ),
}

# ALIASES_COUNT = {
#     alias: sum(LABELS_COUNT[label] for label in ALIASES[alias])
#     for alias in ALIASES
# }
# print(ALIASES_COUNT)
ALIASES_COUNT = {
    "NORMAL": 94072,
    "SQL_INJECTION": 12976,
    "OS_COMMAND_INJECTION": 5785,
    "SERVER_SIDE_TEMPLATE_INJECTION": 3528,
    "SERVER_SIDE_CODE_INJECTION": 504,
    "XML_EXPLOITING": 485,
    "FILE_INCLUSION": 4448,
    "PATH_TRAVERSAL": 5515,
    "CRLF_INJECTION": 357,
    "FORMAT_STRING": 155,
    "BUFFER_OVERFLOW": 59,
    "XSS": 316,
    "OPEN_REDIRECT": 756,
    "PARAMETER_MANIPULATION": 454,
    "FUZZER": 144,
    "INFORMATION_LEAK": 352,
    "SOURCE_CODE_DISCLOSURE": 20,
    "DIRECTORY_INDEXING": 190,
}

SURICATA_MAP = {
    "not-suspicious": ("NORMAL",),
    "unknown": ("NORMAL",),
    "web-application-attack": (
        "SQL_INJECTION",
        "XML_EXPLOITING",
        "FILE_INCLUSION",
        "PATH_TRAVERSAL",
        "CRLF_INJECTION",
        "XSS",
    ),
    "web-application-activity": (
        "OPEN_REDIRECT",
        "PARAMETER_MANIPULATION",
    ),
    "shellcode-detect": (
        "OS_COMMAND_INJECTION",
        "SERVER_SIDE_TEMPLATE_INJECTION",
        "SERVER_SIDE_CODE_INJECTION",
        "BUFFER_OVERFLOW",
        "FORMAT_STRING",
    ),
    "system-call-detect": (
        "OS_COMMAND_INJECTION",
        "SERVER_SIDE_CODE_INJECTION",
        "BUFFER_OVERFLOW",
        "FORMAT_STRING",
    ),
    "attempted-recon": (
        "INFORMATION_LEAK",
        "SOURCE_CODE_DISCLOSURE",
        "DIRECTORY_INDEXING",
    ),
    "successful-recon-limited": (
        "INFORMATION_LEAK",
        "SOURCE_CODE_DISCLOSURE",
        "DIRECTORY_INDEXING",
    ),
    "successful-recon-largescale": (
        "INFORMATION_LEAK",
        "SOURCE_CODE_DISCLOSURE",
        "DIRECTORY_INDEXING",
        "FILE_INCLUSION",
        "PATH_TRAVERSAL",
    ),
    "string-detect": (
        "CRLF_INJECTION",
        "XSS",
        "PARAMETER_MANIPULATION",
    ),
    "suspicious-filename-detect": (
        "DIRECTORY_INDEXING",
        "PATH_TRAVERSAL",
    ),
    "misc-activity": ("FUZZER",),
    "misc-attack": (
        "FUZZER",
        "PARAMETER_MANIPULATION",
    ),
    "bad-unknown": ("FUZZER",),
    "network-scan": ("FUZZER",),
}
